{"ts":1354147150414,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"jQuery(function() {\n\t\t\t/* check default values */\n\t\t\tjQuery.map(['options', 'sites', 'phrases', 'language', 'guess', 'shortcut', 'auto', 'button'], function(key) {\n\t\t\t\tif (localStorage[key] == undefined)\n\t\t\t\t\tlocalStorage[key] = '';\n\t\t\t});\n\n\t\t\t/* setup a listener for the keystroke */\n\t\t\tvar displayKey = function(code) {\n\t\t\t\tvar keys = code.split(/,/);\n\t\t\t\tvar label = (keys[0] == 'true' ? 'shift-' : '')\n\t\t\t\t\t+ (keys[1] == 'true' ? 'alt-': '')\n\t\t\t\t\t+ (keys[2] == 'true' ? 'ctrl-' : '')\n\t\t\t\t\t+ (keys[3] == 'true' ? 'meta-' : '');\n        \n\t\t\t\tif (keys[4] != 0)\n\t\t\t\t\tlabel += String.fromCharCode(keys[4]).toUpperCase();\n\t\t\t\telse\n\t\t\t\t\tlabel += String.fromCharCode(keys[5]).toUpperCase();\n\n\t\t\t\treturn label;\n\t\t\t};\n\n\t\t\t$('#key').keydown(function(e) {\n\t\t\t\t/* surprise! it's a chrome/webkit bug, Ctrl+Key flags both of these to true for me */\n\t\t\t\tif (e.ctrlKey && e.metaKey) \n\t\t\t\t\te.metaKey = false;\n\n\t\t\t\t/* these are the charCodes fired when I press Ctrl/Alt/Meta without another key */\n\t\t\t\tif (e.which == 16 || e.which == 17 || e.which == 18 || e.which == 91)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (e.shiftKey || e.altKey || e.ctrlKey || e.metaKey) {\n\t\t\t\t\tvar code = [e.shiftKey, e.altKey, e.ctrlKey, e.metaKey, e.which, e.charCode].join(',');\n\t\t\t\t\tlocalStorage['shortcut'] = code;\t\t\t\t\n\n\t\t\t\t\t$('#key').val( displayKey(code) );\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\n\t\t\t$('#key').val(displayKey( localStorage['shortcut'] ));\n\n\t\t\t/* setup a listener for auto-proofread changes */\n\t\t\t$('#auto').change(function(event) {\n\t\t\t\tlocalStorage['auto'] = $('#auto').attr('checked');\n\t\t\t\tif (localStorage['auto'] == 'true')\n\t\t\t\t\talert(\"After the Deadline will now check your spelling, style, and grammar before you submit a form.\\n\\nThis feature conflicts with a few sites that use JavaScript to prevent multiple form submits.\\n\\nIf you are unable to submit a form:\\n\\n1) disable this feature\\n\\nor\\n\\n2) click the AtD icon in the address bar and select 'Disable on this site'\");\n\t\t\t});\n\n\t\t\t/* set the auto-proofread settings */\n\t\t\t$('#auto').attr('checked', localStorage['auto'] == 'true' ? true : false);\n\n\t\t\t/* setup a listener for the page action */\n\t\t\t$('#button').change(function(event) {\n\t\t\t\tlocalStorage['button'] = $('#button').attr('checked');\n\t\t\t\tchrome.extension.sendRequest({ command: 'refreshTabs' });\n\t\t\t});\n\n\t\t\t/* set the page action setting */\n\t\t\t$('#button').attr('checked', localStorage['button'] == 'true' ? true : false);\n\n\t\t\t/* setup a listener for the warning dialog thing */\n\t\t\t$('#message').change(function(event) {\n\t\t\t\tlocalStorage['message'] = $('#message').attr('checked');\n\t\t\t});\n\n\t\t\t/* set the page action setting */\n\t\t\t$('#message').attr('checked', localStorage['message'] == 'true' ? true : false);\n\n\t\t\t/* setup a listener to capture changes to the proofreader options */\n\t\t\t$('#proofreader li input').click(function(event) {\n\t\t\t\tvar values = [];\n\t\t\t\t$('#proofreader li :checked').each(function() {\n\t\t\t\t\tvalues.push($(this).attr('name'));\n\t\t\t\t});\n\t\t\t\tlocalStorage['options'] = values.join(', ');\n\t\t\t});\n\n\t\t\t/* set the proofreader options to their initial value */\n\t\t\t$.map(localStorage['options'].split(/,\\s+/), function(item) {\n\t\t\t\t$('#proofreader li input[name=\"'+item+'\"]').attr('checked', true);\n\t\t\t});\t\n\n\t\t\t/* setup a listener to capture changes to the language settings */\n\t\t\t$('#language li select, #language li input').change(function(event) {\n\t\t\t\tlocalStorage['language'] = $('#language li select').val();\n\t\t\t\tlocalStorage['guess'] = $('#language li input').attr('checked');\n\t\t\t});\n\n\t\t\t/* set the language settings */\n\t\t\t$('#language li select').val(localStorage['language']);\n\t\t\t$('#language li input').attr('checked', localStorage['guess'] == 'true' ? true : false);\n\n\t\t\t/* utility functions to make it easier to deal with the add/remove preferences */\n\t\t\tvar showItems = function(parent, items) {\n\t\t\t\tvar element = parent.children().remove();\n\t\t\t\titems.sort();\n\t\t\t\tfor ( var i = 0; i < items.length; i++ ) {\n\t\t\t\t\tif ( items[i].length > 0 )\n\t\t\t\t\t\tparent.append($('<li><span class=\"removeme\">&nbsp;</span> ' + items[i] + '</li>'));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar makeUnique = function(items) {\n\t\t\t\tvar nw = [];\n\t\t\t\tvar seen = {};\n\t\t\t\tfor (var x = 0; x < items.length; x++) {\n\t\t\t\t\tvar tmp = '__' + items[x].trim();\n\t\t\t\t\tif (seen[tmp] == undefined) {\n\t\t\t\t\t\tnw.push(items[x].trim());\n\t\t\t\t\t\tseen[tmp] = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn nw;\n\t\t\t};\n\n\t\t\tvar removeItem = function(item, items) {\n\t\t\t\tvar nw = [];\n\t\t\t\tvar old = items;\n\t\t\t\tfor (var x = 0; x < items.length; x++) {\n\t\t\t\t\tif (items[x] != item)\n\t\t\t\t\t\tnw.push(items[x]);\n\t\t\t\t}\n\t\t\t\treturn nw;\n\t\t\t};\n\n\t\t\tvar addItem = function(field, key, filter) {\n\t\t\t\tvar values  = localStorage[key].split(/,\\s*/);\n\t\t\t\tvar phrases = $(field).val().trim().split(/,\\s*/);\n\t\t\t\tfor (var x = 0; x < phrases.length; x++) {\n\t\t\t\t\tif (filter != undefined)\n\t\t\t\t\t\tvalues.push(filter(phrases[x]));\n\t\t\t\t\telse\n\t\t\t\t\t\tvalues.push(phrases[x]);\n\t\t\t\t}\n\t\t\t\t$(field).val('');\n\t\t\t\tvalues = makeUnique(values);\n\t\t\t\tlocalStorage[key] = values.join(', ');\n\t\t\t\tshowItems($('#' + key), values);\n\t\t\t};\n\n\t\t\t/* setup hooks for the ignored phrases */\n\t\t\t$('#phrases li .removeme').live('click', function(event) {\n\t\t\t\tlocalStorage['phrases'] = removeItem($(event.target).parent().text().trim(), localStorage['phrases'].split(/,\\s*/)).join(', ');\n\t\t\t\t$(event.target).parent().remove();\n\t\t\t});\n\n\t\t\t$('#aphrase').click(function(event) {\n\t\t\t\taddItem('#phrase', 'phrases');\n\t\t\t});\n\n\t\t\t/* setup hooks for the ignored sites */\n\t\t\t$('#sites li .removeme').live('click', function(event) {\n\t\t\t\tlocalStorage['sites'] = removeItem($(event.target).parent().text().trim(), localStorage['sites'].split(/,\\s*/)).join(', ');\n\t\t\t\t$(event.target).parent().remove();\n\t\t\t\tchrome.extension.sendRequest({ command: 'refreshTabs' });\n\t\t\t});\n\n\t\t\t$('#asite').click(function(event) {\n\t\t\t\taddItem('#site', 'sites', function(url) {\n\t\t\t\t\tif (!/https{0,1}:\\/\\/.*/.test(url))\n\t\t\t\t\t\turl = 'http://' + url;\n\n\t\t\t\t\tvar host = new RegExp('(https{0,1}://.*?)/{1}.*').exec(url);\n\t\t\t\t\tif (host == null)\n\t\t\t\t\t\thost = url;\n\t\t\t\t\telse\n\t\t\t\t\t\thost = host[1];\n\t\t\t\t\treturn host;\n\t\t\t\t});\n\n\t\t\t\tchrome.extension.sendRequest({ command: 'refreshTabs' });\n\t\t\t});\n\n\t\t\t/* init the ignored phrases and domains values */\n\t\t\tshowItems($('#phrases'), makeUnique(localStorage['phrases'].split(/,\\s*/)));\n\t\t\tshowItems($('#sites'), makeUnique(localStorage['sites'].split(/,\\s*/)));\n\n\t\t\t/* disable certain options for outdated versions of Chrome */\n\t\t\tif (chrome.pageAction['setPopup'] == undefined)\n\t\t\t\t$('.newonly').hide();\n\t\t});\n"]],"start1":0,"start2":0,"length1":0,"length2":6486}]],"length":6486}
{"contributors":[],"silentsave":false,"ts":1354147999921,"patch":[[{"diffs":[[0,"on(event) {\n\t\t\t\t"],[1,"//"],[0,"localStorage['la"]],"start1":3364,"start2":3364,"length1":32,"length2":34},{"diffs":[[0,"ct').val();\n"],[1,"                localStorage['language'] = $('input:radio[name=language]:checked').val();\n"],[0,"\t\t\t\tlocalSto"]],"start1":3429,"start2":3429,"length1":24,"length2":114},{"diffs":[[0," settings */\n\t\t\t"],[1,"//"],[0,"$('#language li "]],"start1":3630,"start2":3630,"length1":32,"length2":34},{"diffs":[[0,"e : false);\n"],[1,"            \n           \n            if (localStorage['language'] == 'french')\n                $(\"#french\").attr('checked', 'checked');\n            else if (localStorage['language'] == 'german')\n                $(\"#german\").attr('checked', 'checked');\n            else if (localStorage['language'] == 'portuguese')\n                $(\"#portuguese\").attr('checked', 'checked');\n            else if (localStorage['language'] == 'spanish')\n                $(\"#spanish\").attr('checked', 'checked');\n            else\n                $(\"#english\").attr('checked', 'checked');\n                            "],[0,"\n\t\t\t/* utili"]],"start1":3784,"start2":3784,"length1":24,"length2":621}]],"length":7177,"saved":false}
